function res = beehive_flow(time,current_energy_beehive, temp_environment, number_bees, ...
    heat_production_single, insolation, efficiency_of_absorption, projected_area, ...
    thickness_bubble_wrap, thickness_blue_foam, thickness_wall, ...
    thermal_conductivity_bubble_wrap, thermal_conductivity_blue_foam, ...
    thermal_conductivity_wall, area_of_contact_top, area_of_contact_side, ...
    heat_transfer_coefficient_of_air, heat_capacity)

    current_temp_beehive = energyToTemperature(current_energy_beehive , heat_capacity);

    temp_delta = current_temp_beehive - temp_environment;
    
    %The heat generated by bees
    heat_production_total = heat_production_single * number_bees;
    
    %The heat generated by solar radiation
    solar_radiation = efficiency_of_absorption * insolation * projected_area;
    
    %The heat lost by conduction through the top wall, the blue foam and 
    %convection to the air
    conduction_top = thermal_conductivity_wall * area_of_contact_top / ...
        thickness_wall * temp_delta + thermal_conductivity_blue_foam * ...
        area_of_contact_top / thickness_blue_foam * temp_delta + ...
        heat_transfer_coefficient_of_air * area_of_contact_top * temp_delta;
    
    %The heat lost by conduction through the side wall, the blue foam and
    %convection to the air
    conduction_side = thermal_conductivity_wall * area_of_contact_side / ...
        thickness_wall * temp_delta + thermal_conductivity_bubble_wrap * ...
        area_of_contact_side / thickness_bubble_wrap * temp_delta + ...
        heat_transfer_coefficient_of_air * area_of_contact_side * temp_delta;
    
    
    %The total flow function for the beehive model
    res = heat_production_total + solar_radiation - conduction_top - conduction_side;
    
end